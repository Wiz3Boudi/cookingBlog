<div class="px-4 py-5 my-5 text-center">
  <h1 class="display-5 fw-bold">Submit Your Recipe</h1>
  <div class="col-lg-6 mx-auto">
    <p class="lead">Share your amazing recipes with thousands of people
      accross the world. Fill the form to post your story.</p>
  </div>
</div>
<div class="row justify-content-center">
  <div class="col-8">
    <form action="/submit-recipe" enctype="multipart/form-data" method="POST">
      <% if (infoSubmitObj != '') { %>
      <div class="col-8 alert alert-success" role="alert">
        <%= infoSubmitObj %>
      </div>


      <% } %>
      <% if (infoErrorObj != '') { %>
      <div class="col-8 alert alert-danger" role="alert">
        <%= infoErrorObj %>
      </div>


      <% } %>
      <div class="row g-3">
        <div class="col-12">
          <label for="email" class="form-label">Email</label>
          <input value="<%= formValues.email || '' %>" type="email" name="email" id="email" class="form-control">
        </div>
        <div class="col-12">
          <label for="name" class="form-label">Recipe Name</label>
          <input value="<%= formValues.name || '' %>" type="text" name="name" id="name" class="form-control">
        </div>
        <div class="col-12">
          <label for="description" class="form-label">Description</label>
          <textarea name="description" id="description" class="form-control" cols="30" rows="4">
            <%= formValues.description || '' %>
          </textarea>
        </div>
        <div class="col-12">
          <label for="name" class="form-label">Ingredients</label><br>
          <small>Example: Ice</small>
          <div id="ingredientList">
            <small><span style="color: red;">At least add 3
                Ingredients </span>, click the +ngredients
              button to add more ingredients
            </small>
            <% if (formValues.ingredients && formValues.ingredients.length > 0) {%>
            <% formValues.ingredients.forEach(function(val, index) { %>
            <div style="padding-top: 1rem; display: flex;" class="ingredeintDiv mb-1">
              <input value="<%= val %>" placeholder="ingredients" type="text" name="ingredients" class="form-control" style="max-width: 780px;">
              <% if (index > 0) { %>
              <button type="button" onclick="this.parentElement.remove()" style="border: none; background-color: white;"><i class="bi bi-x"></i></button>
              <% } %>
            </div>
            <% }) %>
            <% } else { %>
            <div class="ingredientDiv mb-2">
              <input type="text" name="ingredients" placeholder="ingredients" class="form-control">
            </div>
            <% } %>
          </div>
          <div id="ingredientTemplate" style="display: none;">
            <div class="ingredientsInput">
              <div style="margin: 0.4rem 0; display: flex;">
                <input style="display: inline;" name="ingredients" type="text" placeholder="Ingredient" class="form-control">
                <span class="remove-btn" style="cursor: pointer;">
                  <i class="bi bi-x"></i>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12" style="margin-top: 0.5rem;">
        <button type="button" class="btn btn-outline-primary" id="addIngredientsBtn">+
          Ingredient</button>
      </div>
      <div class="col-12">
        <label style="padding: 1rem 0;" for="category">Select
          Category</label>
        <select class="form-select form-control" name="category" aria-label="Category">
          <option selected> Select Category</option>
          <% if (cutCategoriesValues != '') { %>
          <% cutCategoriesValues.forEach((item, index) => { %>
          <option value="<%= item %>">
            <%= item %>
          </option>
          <% }) %>
          <% } else { %>
          <option selected> Select Category</option>
          <option value="Thai">Thai</option>
          <option value="American">American</option>
          <option value="Chinese">Chinese</option>
          <option value="Mexican">Mexican</option>
          <option value="Indian">Indian</option>


          <% } %>
        </select>
        <p style="margin-bottom: -14px; margin-top: 5px; text-align: start;">
          Or</p>
        <label for="enterCategory"></label>
        <input value="<%= formValues.enterCategory || '' %>" name="enterCategory" class="form-control" type="text" placeholder="Enter Category">
      </div>
      <div class="col-12">
        <label style="padding: 1rem 0;" for="image">Product
          Image</label>
        <input type="file" class="form-control" name="image" accept="image/*">
      </div>
      <div class="col-12" style="padding-top: 1rem;">
        <button type="submit" class="btn btn-primary">Submit
          Recipe</button>
      </div>
  </div>
  </form>
</div>
</div>

<script>
  const addIngredientsBtn = document.getElementById('addIngredientsBtn');
  const ingredientTemplate = document.getElementById('ingredientTemplate');
  const ingredientListContainer = document.getElementById('ingredientList');

  addIngredientsBtn.addEventListener('click', () => {
    const clonedElement = ingredientTemplate.cloneNode(true);
    const ingredientInput = clonedElement.querySelector(
      '.ingredientsInput');

    ingredientInput.style.display = 'block';
    clonedElement.removeAttribute('id');

    const removeBtn = ingredientInput.querySelector('.remove-btn');
    removeBtn.addEventListener('click', function() {
      ingredientInput.remove();
    });

    // Focus on first input
    const firstInput = ingredientInput.querySelector('input');
    if (firstInput) {
      firstInput.focus();
    }

    ingredientListContainer.appendChild(ingredientInput);
  });
</script>